<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Tracking Demo Site (Freshsales)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        .nav-active { @apply bg-indigo-100 text-indigo-700 font-semibold; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg p-4 sticky top-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-extrabold text-indigo-700">Digital Trackers Demo</h1>
            <div id="nav-links" class="space-x-3">
                <button id="nav-home" onclick="showPage('home')" class="nav-btn text-gray-600 hover:text-indigo-700 px-4 py-2 rounded-lg transition duration-150">Home</button>
                <button id="nav-products" onclick="showPage('products')" class="nav-btn text-gray-600 hover:text-indigo-700 px-4 py-2 rounded-lg transition duration-150">Products</button>
                <button id="nav-enquiry" onclick="showPage('enquiry')" class="nav-btn text-gray-600 hover:text-indigo-700 px-4 py-2 rounded-lg transition duration-150">Enquiry Form</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-6xl mx-auto p-6 w-full">

        <!-- HOME Page -->
        <div id="home-page" class="page-content bg-white p-8 rounded-xl shadow-2xl">
            <h2 class="text-4xl font-bold text-gray-800 mb-4">Welcome Home</h2>
            <p class="text-lg text-gray-600 mb-6">This is the low-intent landing page. Every click is tracked to build the lead's profile.</p>
            <img src="https://placehold.co/1000x200/6366F1/FFFFFF?text=Featured+E-commerce+Devices" alt="Featured Products" class="rounded-lg w-full">
            <p class="mt-4 text-sm text-gray-500">Go to the Products page next to simulate higher interest!</p>
        </div>

        <!-- PRODUCTS Page -->
        <div id="products-page" class="page-content bg-white p-8 rounded-xl shadow-2xl hidden">
            <h2 class="text-4xl font-bold text-gray-800 mb-4">Pricing and Specs</h2>
            <p class="text-lg text-red-500 mb-6 font-semibold">ATTENTION: Visits to this page indicate serious buyer intent and should boost the Lead Score!</p>
            <ul class="list-disc list-inside space-y-2 text-gray-600 ml-4">
                <li>Detailed specifications and comparison charts.</li>
                <li>Full pricing breakdown (High-Intent Page).</li>
            </ul>
        </div>

        <!-- ENQUIRY Page (Form Submission Page) -->
        <div id="enquiry-page" class="page-content bg-white p-8 rounded-xl shadow-2xl hidden">
            <h2 class="text-4xl font-bold text-indigo-600 mb-6">Enquire Now</h2>
            <p class="text-lg text-gray-600 mb-6">Submit this form to see the contact created and linked to your browsing history.</p>

            <!-- CRITICAL: Form with ID and Submit button -->
            <form id="checkout-form" class="space-y-4 p-6 bg-indigo-50 rounded-lg border border-indigo-200">
                <div>
                    <label for="full_name" class="block text-sm font-medium text-gray-700">Full Name</label>
                    <input type="text" id="full_name" name="full_name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2">
                </div>
                <div>
                    <label for="email_capture" class="block text-sm font-medium text-gray-700">Email Address (MANDATORY for CRM Contact)</label>
                    <input type="email" id="email_capture" name="email_capture" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2">
                </div>
                <input type="submit" value="Submit Enquiry" class="w-full py-3 px-4 rounded-lg shadow-md text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition duration-150 cursor-pointer">
            </form>
            <div id="form-result" class="mt-4 text-center text-base font-semibold hidden"></div>
        </div>
        
        <!-- SUBMITTED Page (New Page Load) -->
        <div id="submitted-page" class="page-content bg-white p-8 rounded-xl shadow-2xl hidden">
            <h2 class="text-4xl font-bold text-green-600 mb-4">âœ… Success! Form Captured.</h2>
            <p class="text-xl text-gray-700 mb-6">This page view is also tracked!</p>
            <p class="text-lg text-gray-600">The CRM Tracking Code has sent all the form data, and because this is a new URL, a **final page view event** is recorded, confirming the conversion completion. Check your Freshsales Timeline!</p>
        </div>

    </main>

    <!-- Footer for console instructions -->
    <footer class="p-4 bg-gray-200 text-center text-sm text-gray-600">
        <p>ðŸ”´ **DEMO INSTRUCTIONS:** Open Console (F12) to see `[FS TRACKING]` messages recording page visits and form capture success.</p>
    </footer>

    <!-- Freshsales CRM Tracking Code & Page Logic -->
    <script>
        // ----------------------------------------------------
        // CRITICAL: FRESHSALES TRACKING CODE IMPLEMENTATION
        // ----------------------------------------------------
        
        const FRESHSALES_HOST = 'yourdomain.myfreshworks.com'; // <<< REPLACE THIS!

        // Function to simulate the Freshsales script logging a page view.
        function trackPageView(pageId) {
            const simulatedUrl = `https://demo-ecommerce-site.com/#${pageId}`;
            
            // Log the simulated visit to the console for demonstration
            console.log(`[FS TRACKING] Page Visit Recorded: ${pageId.toUpperCase()}`);
            console.log(`[FS TRACKING] Simulated URL: ${simulatedUrl}`);
            
            // NOTE: In a real implementation, the Freshsales script would handle this automatically on each page load.
        }

        // 2. Load the actual Freshsales tracking code (using a placeholder)
        const FRESHSALES_TRACKING_SCRIPT = `
            var FSSettings = {
                host: 'https://${FRESHSALES_HOST}',
                version: 1,
                siteUrl: 'https://demo-ecommerce-site.com' 
            };
            (function() {
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.src = 'https://${FRESHSALES_HOST}/crm/sales/form/latest/js/form-api.min.js';
                var firstScript = document.getElementsByTagName('script')[0];
                firstScript.parentNode.insertBefore(script, firstScript);
            })();
            console.log("[FS TRACKING] Tracker Initialized. Ready to capture events.");
        `;
        document.body.insertAdjacentHTML('beforeend', `<script>${FRESHSALES_TRACKING_SCRIPT}</script>`);


        // ----------------------------------------------------
        // WEBSITE LOGIC (Page Switching & Form Handling)
        // ----------------------------------------------------
        
        function showPage(pageId) {
            // Hide all content areas
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            // Remove active style from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('nav-active');
            });

            // Show the requested content area and mark navigation button as active
            const targetPage = document.getElementById(pageId + '-page');
            const targetNav = document.getElementById('nav-' + pageId);
            
            if (targetPage) {
                targetPage.classList.remove('hidden');
                
                if (targetNav) {
                    targetNav.classList.add('nav-active');
                }
                
                // CRITICAL STEP: Trigger the tracking function on each page change
                trackPageView(pageId); 

                // Update URL for clear demonstration
                history.pushState(null, '', `#${pageId}`); 
            }
        }

        // Form Submission Handler
        document.getElementById('checkout-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const emailInput = e.target.querySelector('#email_capture').value;
            
            if (!emailInput) return; // Should not happen with 'required' attribute, but safe guard.

            // 1. Simulate Form Capture (Done by FS Tracking Code automatically)
            console.log(`[FS TRACKING] Form Submission captured for email: ${emailInput}!`);
            
            // 2. Clear the form
            e.target.reset();

            // 3. Redirect (Show the Submission Success Page)
            showPage('submitted');
        });


        // Initial Load: Show the home page when the file is opened
        window.onload = function() {
            const initialPage = window.location.hash.substring(1) || 'home';
            showPage(initialPage);
        };
        
    </script>

</body>
</html>
